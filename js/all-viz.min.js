function draw_world(){function t(t){var e,l,i;if(t&&a!==t){var o=s.centroid(t);e=o[0],l=o[1],i=4,a=t}else e=n/2,l=r/2,i=1,a=null;c.selectAll("path").classed("active",a&&function(t){return t===a}),c.transition().duration(750).attr("transform","translate("+n/2+","+r/2+")scale("+i+")translate("+-e+","+-l+")").style("stroke-width",1.5/i+"px")}function e(){var t,e,l;t=n/2,e=r/2,l=1,a=null,c.selectAll("path").classed("active",a&&function(t){return t===a}),c.transition().duration(750).attr("transform","translate("+n/2+","+r/2+")scale("+l+")translate("+-t+","+-e+")").style("stroke-width",1.5/l+"px")}var a,n=1050,r=500,l=d3.select("body").append("div").attr("class","map-tooltip").style("position","absolute"),i=d3.scale.sqrt().domain([1,100]).range([3,25]),o=d3.geo.equirectangular().translate([n/2,r/2+20]).scale(160).clipExtent([[0,0],[1050,450]]),s=d3.geo.path().projection(o),d=d3.select("#world-map").append("svg").attr("width",n).attr("height",r);d.append("rect").attr("width",n).attr("height",r).attr("class","map-container").on("click",t);var c=d.append("g");d3.json("data/world-110m.json",function(e,a){map_data=topojson.feature(a,a.objects.countries).features,d3.csv("data/ventures_by_country_id.csv",function(e,a){for(var n=a.length,r=map_data.length,d=0;n>d;d++)for(var p=0;r>p;p++)map_data[p].id==a[d].id&&(map_data[p].value=+a[d].value,map_data[p].lon=+a[d].lon,map_data[p].lat=+a[d].lat,map_data[p].name=a[d].name);filt_data=map_data.filter(function(t){return t.value}),c.selectAll("circle").data(filt_data).enter().append("circle").attr("class","map-circle").attr("cx",function(t){return o([t.lon,t.lat])[0]}).attr("cy",function(t){return o([t.lon,t.lat])[1]}).attr("r",function(t){return i(t.value)}),c.selectAll("path").data(map_data).enter().append("path").attr("d",s).attr("class","country").on("mouseenter",function(t){t.value&&(name=t.name,value=t.value,l.html(name+" <b>"+value+"</b>").style("left",d3.event.pageX-15+"px").style("top",d3.event.pageY+50+"px").style("opacity",1))}).on("mouseleave",function(){l.style("opacity",0)}).on("click",t)})}),d3.select("#zoom-text-world").html("Click on map to zoom in. Hover for details. &nbsp;&nbsp;"),d3.select("#zoom-out-world").on("click",e)}function draw_usmap(){function t(t){var e,l,i;if(t&&a!==t){if("Feature"==t.type){var d=s.centroid(t);e=d[0],l=d[1]}else e=o([t.lon,t.lat])[0],l=o([t.lon,t.lat])[1];i=4,a=t}else e=n/2,l=r/2,i=1,a=null;c.selectAll("path").classed("active",a&&function(t){return t===a}),c.transition().duration(750).attr("transform","translate("+n/2+","+r/2+")scale("+i+")translate("+-e+","+-l+")").style("stroke-width",1.5/i+"px")}function e(){var t,e,l;t=n/2,e=r/2,l=1,a=null,c.selectAll("path").classed("active",a&&function(t){return t===a}),c.transition().duration(750).attr("transform","translate("+n/2+","+r/2+")scale("+l+")translate("+-t+","+-e+")").style("stroke-width",1.5/l+"px")}var a,n=1050,r=500,l=d3.select("body").append("div").attr("class","map-tooltip").style("position","absolute"),i=d3.scale.sqrt().domain([1,600]).range([2,20]),o=d3.geo.albersUsa().translate([n/2,r/2]).scale(1e3),s=d3.geo.path().projection(o),d=d3.select("#us-map").append("svg").attr("width",n).attr("height",r);d.append("rect").attr("width",n).attr("height",r).attr("class","map-container").on("click",t);var c=d.append("g");d3.json("data/us-states.json",function(e,a){c.selectAll("path").data(a.features).enter().append("path").attr("class","state").attr("d",s).on("click",t),d3.csv("data/ventures_by_city_us.csv",type,function(e,a){a.sort(function(t,e){return e.value-t.value}),c.selectAll("circle").data(a).enter().append("circle").attr("class","map-circle").attr("cx",function(t){return o([t.lon,t.lat])[0]}).attr("cy",function(t){return o([t.lon,t.lat])[1]}).attr("r",function(t){return i(t.value)}).on("mouseover",function(t){desc=t.desc,value=t.value,l.html(desc+" <b>"+value+"</b>").style("left",d3.event.pageX-15+"px").style("top",d3.event.pageY+50+"px").style("opacity",1),d3.select(this).style("fill","white")}).on("mouseleave",function(){l.style("opacity",0),d3.select(this).style("fill","orange")}).on("click",t)})}),d3.select("#zoom-text-us").html("Click on map to zoom in. Hover for details. &nbsp;&nbsp;"),d3.select("#zoom-out-us").on("click",e)}function type(t){return t.value=+t.value,t.lon=+t.lon,t.lat=+t.lat,t}function draw_vamap(){function t(t){var e,l,i;t&&a!==t?"Feature"==t.type?(e=n/2,l=r/2,i=1,a=null):(e=o([t.lon,t.lat])[0],l=o([t.lon,t.lat])[1],i=4,a=t):(e=n/2,l=r/2,i=1,a=null),c.selectAll("path").classed("active",a&&function(t){return t===a}),c.transition().duration(750).attr("transform","translate("+n/2+","+r/2+")scale("+i+")translate("+-e+","+-l+")").style("stroke-width",1.5/i+"px")}function e(){var t,e,l;t=n/2,e=r/2,l=1,a=null,c.selectAll("path").classed("active",a&&function(t){return t===a}),c.transition().duration(750).attr("transform","translate("+n/2+","+r/2+")scale("+l+")translate("+-t+","+-e+")").style("stroke-width",1.5/l+"px")}var a,n=1050,r=500,l=d3.select("body").append("div").attr("class","map-tooltip").style("position","absolute"),i=d3.scale.sqrt().domain([1,600]).range([2,40]),o=d3.geo.mercator().translate([n/2,r/2]).scale(6500).center([-79.4,37.968]),s=d3.geo.path().projection(o),d=d3.select("#va-map").append("svg").attr("width",n).attr("height",r);d.append("rect").attr("width",n).attr("height",r).attr("class","map-container").on("click",t);var c=d.append("g");d3.json("data/va.geo.json",function(e,a){c.selectAll("path").data(a.features).enter().append("path").attr("class","state").attr("d",s).on("click",t),d3.csv("data/ventures_by_city_va.csv",type,function(e,a){a.sort(function(t,e){return e.value-t.value}),c.selectAll("circle").data(a).enter().append("circle").attr("class","map-circle").attr("cx",function(t){return o([t.lon,t.lat])[0]}).attr("cy",function(t){return o([t.lon,t.lat])[1]}).attr("r",function(t){return i(t.value)}).on("mouseover",function(t){desc=t.desc,value=t.value,l.html(desc+" <b>"+value+"</b>").style("left",d3.event.pageX-15+"px").style("top",d3.event.pageY+50+"px").style("opacity",1),d3.select(this).style("fill","white")}).on("mouseleave",function(){l.style("opacity",0),d3.select(this).style("fill","orange")}).on("click",t)})}),d3.select("#zoom-text-va").html("Click on a circle to zoom in. Hover for details. &nbsp;&nbsp;"),d3.select("#zoom-out-va").on("click",e)}function type(t){return t.value=+t.value,t.lon=+t.lon,t.lat=+t.lat,t}function draw_chart_which_alumni(t){function e(e,n,o){var s=c.selectAll(e).data(a).enter().append("g");s.append("line").classed(n,!0).classed("line-inside-chart",!0).attr("x1","0").attr("y1",function(t){return"freq_ent"===o?l(t.name):l(t.name)+10}).attr("x2",function(t){return i(t[o])}).attr("y2",function(t){return"freq_ent"===o?l(t.name):l(t.name)+10}),d.on("mouseenter",function(){d3.selectAll(t.id+" .text-on-bar").transition().style("opacity",1)}).on("mouseleave",function(){d3.selectAll(t.id+" .text-on-bar").transition().style("opacity",0)}),s.append("text").attr("class","text-on-bar").attr("x",function(t){return i(t[o])}).attr("dx",".4em").attr("y",function(t){return"freq_ent"==o?l(t.name)-9:l(t.name)+l.rangeBand()/2}).attr("dy","1.2em").text(function(t){return r(t[o])}).style("opacity",0)}var a,n=t.w-t.margin.left-t.margin.right,r=d3.format(".0%"),l=d3.scale.ordinal(),i=d3.scale.linear().range([0,n]),o=d3.svg.axis().scale(i).orient("bottom").ticks(5,"%").tickFormat(r);a=t.data.filter(function(e){return e.kind==t.kind}),"demog"!==t.kind&&a.sort(function(t,e){return t.freq_ent-e.freq_ent});var s=40*a.length-t.margin.top-t.margin.bottom,d=d3.select(t.id).append("svg").attr("width",n+t.margin.left+t.margin.right).attr("height",s+t.margin.top+t.margin.bottom),c=d.append("g").attr("transform","translate("+t.margin.left+","+t.margin.top+")");i.domain([0,d3.max(a.map(function(t){return d3.max([t.freq_ent,t.freq_nent])}))]),l.rangeRoundBands([0,s],.8,.1);var p=d3.svg.axis().scale(l).orient("left");l.domain(a.map(function(t){return t.name})),c.append("g").classed("x axis",!0).attr("transform","translate(0, "+s+")").call(o),c.append("g").classed("y axis",!0).call(p),e("g .ent","ent","freq_ent"),e("g .nent","nent","freq_nent")}function type(t){return t.freq_ent=+t.freq_ent,t.freq_nent=+t.freq_nent,t}function draw_chart_age(t){function e(e,a,i){{var o=d3.svg.area().x(function(t){return r(t.age)}).y0(n).y1(function(t){return l(t[i])}).interpolate("cardinal");d.append("path").datum(t.data).attr("class",a).classed("area",!0).attr("d",function(t){return o(t)})}s.on("mouseenter",function(){d3.selectAll(".ratio").transition().duration(500).style("opacity",1),d3.selectAll(".area").transition().duration(2e3).style("opacity","0.2")}).on("mouseleave",function(){d3.selectAll(".ratio").transition().duration(500).style("opacity",0),d3.selectAll(".area").transition().duration(2e3).style("opacity","0.9")})}var a=t.w-t.margin.left-t.margin.right,n=t.h-t.margin.top-t.margin.bottom,r=d3.scale.linear().domain([24,84]).range([0,a]),l=d3.scale.linear().domain([0,d3.max(t.data,function(t){return d3.max([t.ent,t.nent])})]).range([n,0]),i=d3.svg.axis().scale(r).orient("bottom").ticks(10),o=d3.svg.axis().scale(l).orient("left").ticks(4),s=d3.select(t.id).append("svg").attr("width",a+t.margin.left+t.margin.right).attr("height",n+t.margin.top+t.margin.bottom),d=s.append("g").attr("transform","translate("+t.margin.left+","+t.margin.top+")");d.append("g").attr("class","x axis").attr("transform","translate(0, "+n+")").call(i),d.append("g").attr("class","y axis").call(o),e("path .nent","nent-area","nent"),e("path .ent","ent-area","ent"),d.append("svg:text").text("Number of alumni").attr("class","axis-label").attr("transform","translate(-50,"+n/2+") rotate(-90)"),d.append("svg:text").text("Age of alumni").attr("class","axis-label").attr("transform","translate("+a/2+", "+n+")").attr("dy","3em"),d.append("svg:text").text("Non-entrepreneurs").attr("class","axis-label").attr("transform","translate(80, 120)"),d.append("svg:text").text("Entrepreneurs").attr("class","axis-label").attr("transform","translate(80, "+n+")").attr("dy","-2em"),y_ratio=d3.scale.linear().domain([0,1]).range([n,0]),line=d3.svg.line().x(function(t){return r(t.age)}).y(function(t){return y_ratio(t.ratio)}).interpolate("cardinal");var c=d3.svg.axis().scale(y_ratio).orient("right").ticks(5);d.append("g").attr("transform","translate("+a+", 0)").attr("class","y axis").call(c).classed("ratio",!0).style("opacity",0),d.append("svg:path").datum(t.data).attr("class","line").classed("ratio",!0).attr("d",line).style("opacity",0),d.append("text").text("Ratio of Entrepreneurs to Non-entrepreneurs").attr("class","axis-label").classed("ratio",!0).attr("x",a-150).attr("y",30).style("opacity",0)}function type(t){return t.age=+t.age,t.ent=+t.ent,t.nent=+t.nent,t.ratio=+t.ratio,t}(function(){var t,e,a,n,r;a=d3.format(".0%"),t=d3.format("0,000"),d3.csv("data/ventures_by_decade.csv",function(e){var a,l,i,o,s,d,c,p,u,m,f,g,h,v,y,x,_,w,b,k,q,A;x=function(){var t,a,n;for(n=[],t=0,a=e.length;a>t;t++)f=e[t],n.push({name:f.name,value:+f.value_total,freq:+f.freq_total,kind:f.kind});return n}(),i=function(){var t,a,n;for(n=[],t=0,a=e.length;a>t;t++)f=e[t],n.push({name:f.name,value:+f.value_1960s,freq:+f.freq_1960s,kind:f.kind});return n}(),o=function(){var t,a,n;for(n=[],t=0,a=e.length;a>t;t++)f=e[t],n.push({name:f.name,value:+f.value_1970s,freq:+f.freq_1970s,kind:f.kind});return n}(),s=function(){var t,a,n;for(n=[],t=0,a=e.length;a>t;t++)f=e[t],n.push({name:f.name,value:+f.value_1980s,freq:+f.freq_1980s,kind:f.kind});return n}(),d=function(){var t,a,n;for(n=[],t=0,a=e.length;a>t;t++)f=e[t],n.push({name:f.name,value:+f.value_1990s,freq:+f.freq_1990s,kind:f.kind});return n}(),c=function(){var t,a,n;for(n=[],t=0,a=e.length;a>t;t++)f=e[t],n.push({name:f.name,value:+f.value_2000s,freq:+f.freq_2000s,kind:f.kind});return n}(),p=function(){var t,a,n;for(n=[],t=0,a=e.length;a>t;t++)f=e[t],n.push({name:f.name,value:+f.value_2010s,freq:+f.freq_2010s,kind:f.kind});return n}(),u=[{decade:"1960s",value:119},{decade:"1970s",value:494},{decade:"1980s",value:1310},{decade:"1990s",value:2147},{decade:"2000s",value:3341},{decade:"2010s",value:1233}],v={top:30,right:0,bottom:30,left:0},_=500,g=300,w=_-v.left-v.right,h=g-v.top-v.bottom,b=d3.scale.ordinal().domain(u.map(function(t){return t.decade})).rangeRoundBands([0,w],.25),q=d3.scale.linear().domain([0,3341]).range([h,0]),k=d3.svg.axis().scale(b).orient("bottom"),A=d3.svg.axis().scale(q).orient("left").tickFormat(t),y=d3.select("#decades").append("svg").attr("width",w+v.left+v.right).attr("height",h+v.top+v.bottom).attr("display","block").classed("center",!0),l=y.append("g").attr("transform","translate("+v.left+", "+v.top+")"),l.append("g").attr("class","x axis").attr("transform","translate(0, "+h+")").call(k),a=l.selectAll(".bargroup").data(u).enter().append("g").classed("bargroup",!0),a.append("rect").attr("class","decade_bar").attr("x",function(t){return b(t.decade)}).attr("y",function(t){return q(t.value)}).attr("width",b.rangeBand()).attr("height",function(t){return h-q(t.value)}).on("mouseenter",function(){return d3.select(this).transition().style("opacity",.3)}).on("mouseleave",function(){return d3.select(this).transition().style("opacity",1)}).on("click",function(){var t=d3.select(this).datum().decade;m(t),d3.select("#decade-caption").html("Ventures Founded in "+t).style("opacity",0).transition().duration(600).style("opacity",1)}),a.append("text").attr("class","text-on-bar").attr("x",function(t){return b(t.decade)}).attr("text-anchor","middle").attr("dx",b.rangeBand()/2).attr("y",function(t){return q(t.value)}).attr("dy","-1.2em").text(function(e){return t(e.value)}).style("opacity",1),m=function(t){var e;"total"===t&&(e=x),"1960s"===t&&(e=i),"1970s"===t&&(e=o),"1980s"===t&&(e=s),"1990s"===t&&(e=d),"2000s"===t&&(e=c),"2010s"===t&&(e=p),n({data:e,kind:"legal",w:400,h:200,targetId:"#legal",margin:{top:0,right:30,bottom:30,left:160}}),n({data:e,kind:"ind",w:400,h:200,targetId:"#ind",margin:{top:0,right:30,bottom:30,left:230}}),r({data:e,kind:"status",w:200,h:200,targetId:"#status",margin:{top:0,right:0,bottom:30,left:0}})},m("total"),d3.select("#show-total").on("click",function(){m("total"),d3.select("#decade-caption").html("All Ventures").style("opacity",0).transition().duration(600).style("opacity",1)})}),r=function(t){var n,r,l,i,o,s,d,c,p,u,m;d3.select(t.targetId).select("svg").remove(),i=e(t.kind,t.data),m=t.w-t.margin.left-t.margin.right,s=t.h-t.margin.top-t.margin.bottom,p=Math.min(m,s)/2,l=d3.scale.ordinal().domain(i.map(function(t){return t.name})).range(["#adc1cd","#cccc99","#fff"]),n=d3.svg.arc().outerRadius(p-10).innerRadius(30),c=d3.layout.pie().sort(null).value(function(t){return t.freq}),u=d3.select(t.targetId).append("svg").attr("width",t.w).attr("height",t.h),r=u.append("g").attr("transform","translate("+(m/2+t.margin.left)+", "+(s/2+t.margin.top)+")"),o=r.selectAll(".arc").data(c(i)).enter().append("g").attr("class","arc"),o.append("path").attr("d",n).style("fill","white").transition().duration(400).style("fill",function(t){return l(t.data.name)}),o.append("text").attr("transform",function(t){return"translate("+n.centroid(t)+")"}).style("text-anchor","middle").text(function(t){return t.data.freq>.03?a(t.data.freq):void 0}).classed("text-on-bar",!0).style("opacity",0).transition().duration(400).style("opacity",1),d=u.selectAll("g .legends").data(i).enter().append("g").classed("legends",!0).attr("transform",function(e,a){return"translate("+(60*a+7)+", "+(t.h-25)+")"}),d.append("rect").attr("x",0).attr("y",0).attr("width",60).attr("height",20).style("fill",function(t){return l(t.name)}).style("stroke-dasharray","60, 20, 60, 20").style("stroke","lightgray").style("stroke-width","0.5"),d.append("text").attr("text-anchor","middle").attr("x",30).attr("y",10).attr("dy",".3em").classed("text-on-bar",!0).text(function(t){return t.name})},n=function(n){var r,l,i,o,s,d,c,p,u,m;d3.select(n.targetId).select("svg").remove(),i=e(n.kind,n.data),d=n.w-n.margin.left-n.margin.right,o=n.h-n.margin.top-n.margin.bottom,c=d3.scale.linear().domain([0,d3.max(i,function(t){return t.freq})]).range([0,d]),u=d3.scale.ordinal().domain(i.map(function(t){return t.name})).rangeRoundBands([0,o],.1),p=d3.svg.axis().scale(c).orient("bottom").tickFormat(a).ticks(3),m=d3.svg.axis().scale(u).orient("left"),s=d3.select(n.targetId).append("svg").attr("width",d+n.margin.left+n.margin.right).attr("height",o+n.margin.top+n.margin.bottom),l=s.append("g").attr("transform","translate("+n.margin.left+", "+n.margin.top+")"),l.append("g").attr("class","x axis").attr("transform","translate(0, "+o+")").call(p),l.append("g").attr("class","y axis").call(m),r=l.selectAll(".bargroup").data(i).enter().append("g").classed("bargroup",!0),r.append("rect").attr("class","decade_small_bar").attr("y",function(t){return u(t.name)}).attr("height",u.rangeBand()).attr("width",0).transition().duration(400).attr("width",function(t){return c(t.freq)}),r.append("text").attr("class","text-on-bar").attr("x",function(t){return c(t.freq)}).attr("dx",".2em").attr("y",function(t){return u(t.name)}).attr("dy",u.rangeBand()/2).text(function(e){return t(e.value)}).style("opacity",0).transition().duration(400).style("opacity",1)},e=function(t,e){var a;return a=e.filter(function(e){return e.kind===t}),"ind"===t&&(a.sort(function(t,e){return e.value-t.value}),a=a.filter(function(t){return"Non-Profit"!==t.name}),a=a.filter(function(t,e){return 5>=e})),a}}).call(this),function(){var t,e=d3.scale.ordinal().domain(["Incorporated company","Partnership","Informal","Non-profit","Franchisee","Not reported","Sole proprietorship"]).range(["steelblue","slateblue","firebrick","orangered","darkgreen","gray","darkseagreen"]);t=function(t){var a,n,r,l,i,o,s;a=d3.format("0,000"),s=d3.select("body").append("div").attr("class","map-tooltip").style("position","absolute"),i=d3.scale.sqrt().domain(t.domainScale).range(t.rangeScale),l=d3.layout.pack().sort(function(t,e){return e.value-t.value}).size([t.w,t.h]).value(function(t){return t.value}).padding(2).radius(function(t){return i(t)}),o=d3.select(t.idTarget).append("svg").attr("width",t.w).attr("height",t.h),n=d3.nest().key(function(t){return t.name}).entries(t.contData[0]),n.forEach(function(t){return t.children=t.values}),r=l.nodes({children:n}),o.selectAll("circle").data(r).enter().append("circle").attr("r",function(t){return t.r}).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}).style("fill",function(t){return t.children?"white":e(t.parent.key)}).on("mouseover",function(t){return t.children?void 0:s.html(t.name+" <b>"+a(t.value)+"</b>").style("left",d3.event.pageX-15+"px").style("top",d3.event.pageY+50+"px").style("opacity",1)}).on("mouseleave",function(){return s.style("opacity",0)})},d3.csv("data/all_vent_contrib.csv",function(a){function n(){return s!==!1?!1:(s=!0,d3.select("#rev-dist").append("h3").html("Maximum Revenue Generated in A Year").append("p").html("&nbsp;"),d3.select("#cap-dist").append("h3").html("Maximum Capital Raised in a Year").append("p").classed("small",!0).html("For non-profits, the amount shown is maximum donation raised in a year."),t({w:600,h:600,domainScale:[0,15e9],rangeScale:[0,50],idTarget:"#rev-dist",contData:o}),t({w:400,h:400,domainScale:[0,3e10],rangeScale:[0,60],idTarget:"#cap-dist",contData:r}),void 0)}var r,l,i,o;i=[function(){var t,e,n;for(n=[],t=0,e=a.length;e>t;t++)l=a[t],n.push({value:+l.employment,name:l.typorg});return n}()],o=[function(){var t,e,n;for(n=[],t=0,e=a.length;e>t;t++)l=a[t],n.push({value:+l.max_revenue,name:l.typorg});return n}()],r=[function(){var t,e,n;for(n=[],t=0,e=a.length;e>t;t++)l=a[t],n.push({value:+l.max_capital,name:l.typorg});return n}()],t({w:600,h:600,domainScale:[0,12e3],rangeScale:[0,30],idTarget:"#emp-dist",contData:i});var s=!1,d=!1;d3.select("#btnRevCap").on("click",n),d3.select("#btnRevCap").on("mouseover",function(){d===!1&&(d=!0,d3.select("#expRevCap").append("p").html("Charts will appear below in a few seconds after clicking."))}),legend_data=["Incorporated company","Non-profit","Partnership","Sole proprietorship","Franchisee","Informal","Not reported"],legends=d3.select("#distrib-legends").append("svg").attr("width",250).attr("height",210).selectAll("g .legends").data(legend_data).enter().append("g").classed("legends",!0).attr("transform",function(t,e){return"translate(0, "+20*e+")"}),legends.append("rect").attr("x",200).attr("y",0).attr("width",50).attr("height",17).style("fill",function(t){return e(t)}),legends.append("text").attr("text-anchor","middle").attr("x",100).attr("y",10).attr("dy",".3em").style("fill","black").text(function(t){return t})})}.call(this),function(){function t(t){i=d3.select("#"+t).append("svg:svg").attr("width",s+l).attr("height",r+o).attr("display","block").classed("center",!0),a=i.append("svg:defs").append("svg:linearGradient").attr("id","gradient").attr("x1","0%").attr("y1","0%").attr("x2","270%").attr("y2","50%").attr("spreadMethod","pad"),a.append("svg:stop").attr("offset","0%").attr("stop-color","#fff").attr("stop-opacity",1),"emp"===t||"rev"===t||"exp"===t||"ccap"===t?a.append("svg:stop").attr("offset","100%").attr("stop-color","#235281").attr("stop-opacity",1):a.append("svg:stop").attr("offset","100%").attr("stop-color","#CF7800").attr("stop-opacity",1),n=i.append("g").attr("transform","translate("+l/2+", "+o/2+")"),n.append("svg:rect").attr("width",s).attr("height",r).style("fill","url(#gradient)"),n.append("text").attr("text-anchor","middle").attr("x",0).attr("x","2em").attr("y",r/2).attr("dy",".5em").text(e[t].lo),n.append("text").attr("text-anchor","middle").attr("x",0).attr("x","2em").attr("y",r).attr("dy",".8em").text("Low estimate"),n.append("text").attr("text-anchor","middle").attr("x",s).attr("dx","-2em").attr("y",r/2).attr("dy",".5em").text(e[t].hi),n.append("text").attr("text-anchor","middle").attr("x",s).attr("dx","-2em").attr("y",r).attr("dy",".8em").text("High estimate"),n.append("text").attr("text-anchor","middle").attr("font-family","open sans").attr("font-size","30px").attr("font-variant","small-caps").attr("x",s/2).attr("y",r/2).attr("dy",".4em").text(e[t].mi)}var e,a,n,r,l,i,o,s;e={rev:{lo:"1.2T",mi:"1.6 Trillion",hi:"2.0T"},exp:{lo:"0.7T",mi:"0.9 Trillion",hi:"1.1T"},emp:{lo:"1.7M",mi:"2.3 Million",hi:"2.9M"},ccap:{lo:"1.6T",mi:"2.1 Trillion",hi:"2.7T"},revVa:{lo:"294B",mi:"395 Billion",hi:"505B"},expVa:{lo:"208B",mi:"279 Billion",hi:"356B"},empVa:{lo:"278K",mi:"371 Thousand",hi:"477K"},ccapVa:{lo:"124B",mi:"167 Billion",hi:"213B"}},s=300,r=40,o=40,l=50,t("emp"),t("rev"),t("exp"),t("ccap"),t("revVa"),t("expVa"),t("empVa"),t("ccapVa")}.call(this),draw_world();var tooltip=d3.select("body").append("div").attr("class","map-tooltip").style("position","absolute"),w=800,h=600,va_lon_lat=[-78.169968,37.769335],svg=d3.select("#outstate").append("svg").attr("width",w).attr("height",h),wScale=d3.scale.linear().domain([1,77]).range([1,15]),cScale=d3.scale.linear().domain([1,77]).range(["#FFE4E4","#FC0000"]),projection=d3.geo.albersUsa().translate([w/2,h/2]).scale([1e3]),path=d3.geo.path().projection(projection);d3.json("data/us-states.json",function(t){d3.csv("data/outstate_va.csv",function(e){for(var a=e.length,n=t.features.length,r=0;a>r;r++)for(var l=0;n>l;l++)e[r].state==t.features[l].properties.name&&(t.features[l].properties.value=+e[r].value);svg.selectAll("line").data(e).enter().append("line").classed("outstate_line",!0).style("opacity","0.6").attr("stroke-width",function(t){return wScale(t.value)}).attr("x1",function(t){return projection([t.lon_state,t.lat_state])[0]}).attr("y1",function(t){return projection([t.lon_state,t.lat_state])[1]}).attr("x2",function(){return projection(va_lon_lat)[0]}).attr("y2",function(){return projection(va_lon_lat)[1]}),svg.selectAll("path").data(t.features).enter().append("path").attr("d",path).classed("state",function(t){return"Virginia"===t.properties.name?!1:!0}).attr("fill","steelblue").attr("stroke","black").classed("oustate",!0).on("mouseenter",function(t){t.properties.value&&(name=t.properties.name,value=t.properties.value,tooltip.html(name+" <b>"+value+"</b>").style("left",d3.event.pageX-15+"px").style("top",d3.event.pageY+50+"px").style("opacity",1))}).on("mouseleave",function(){tooltip.style("opacity",0)})})}),draw_usmap(),draw_vamap(),d3.csv("data/ent_vs_nent.csv",type,function(t,e){draw_chart_which_alumni({data:e,id:"#experience",kind:"experience",w:600,margin:{top:0,right:30,bottom:20,left:420}}),draw_chart_which_alumni({data:e,id:"#field",kind:"field",w:500,margin:{top:0,right:30,bottom:20,left:150}}),draw_chart_which_alumni({data:e,id:"#degree",kind:"degree",w:500,margin:{top:0,right:30,bottom:20,left:70}}),draw_chart_which_alumni({data:e,id:"#demog",kind:"demog",w:400,margin:{top:0,right:30,bottom:20,left:200}}),legend_data=["% of Entrepreneurial Alumni","% of Non-entrepreneurial Alumni"],legendColor=d3.scale.ordinal().domain(legend_data).range(["#235281","#adc1cd"]),legends=d3.select("#which-alum-legends").append("svg").attr("width",600).attr("height",30).selectAll("g .legends").data(legend_data).enter().append("g").classed("legends",!0).attr("transform",function(t,e){return"translate("+300*e+", 0)"}),legends.append("rect").attr("x",0).attr("y",0).attr("width",300).attr("height",30).style("fill",function(t){return legendColor(t)}),legends.append("text").attr("text-anchor","middle").attr("x",150).attr("y",15).attr("dy",".3em").style("fill",function(t,e){return 1===e?"black":"white"}).text(function(t){return t})}),d3.csv("data/age.csv",type,function(t,e){draw_chart_age({data:e,id:"#age",w:500,h:300,margin:{top:20,right:60,bottom:40,left:60}})});